# MongoDB使用教程



## 一. MongoDB基础

### 1.1 MongoDB介绍

> MongoDB 是由C++语言编写的，是一个**基于分布式文件存储的开源数据库系统**。
>
> MongoDB 旨在**为WEB应用提供可扩展的高性能数据存储解决方案**。
>
> MongoDB 将数据存储为一个文档，**数据结构由键值(key=>value)对组成。**MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。

**参考地址：**

- [mongodb官网地址](https://www.mongodb.com/)

- [官方英文文档](https://docs.mongodb.com/manual/)

- [mongoDB各平台下载地址](https://www.mongodb.com/download-center#community)

### 1.2 基本概念

> mongoDB中的概念和我们原始的数据库有些不同，具体见以下介绍

| SQL术语/概念 | MongoDB术语/概念 | 解释说明                      |
| ------------ | ---------------- | ----------------------------- |
| database     | database         | 数据库                        |
| table        | collection       | 数据表/集合                   |
| row          | document         | 数据记录行/文档               |
| column       | field            | 数据字段/域                   |
| index        | index            | 索引                          |
| table joins  |                  | 表连接，MongoDB不支持         |
| primary key  | primary key      | 主键，mongoDB自动将id作为主键 |

转换为数据关系即如下所示：

![](./imgs/mango-01.jpg)

### 1.3 安装

网上的安装教程千遍一律，我这里也不做具体介绍，在此推荐一些安装教程，需要的小伙伴可以按照如下推荐的教程一步步安装即可

- [菜鸟教程：mongodb的下载与安装](https://www.runoob.com/mongodb/mongodb-window-install.html)
- [博客园：mongodb的下载，安装，配置](https://www.cnblogs.com/minily/p/9431609.html)



### 1.4 启动 MongoDb服务器

> 启动MongoDB服务器的方式有两种，以下两种方法，任选一种即可

#### 方法1：命令行下运行MongoDB服务器

1. 配置环境变量，将 mongodb安装完成之后的 bin目标，添加到环境变量的 path中去
2. 打开命令行，输入 `mongod`
3. 新打开一个命令行，输入 `mongo` 即可连接成功

4. 通过浏览器访问 `http://127.0.0.1:27017`，展示 `It looks like you are trying to access MongoDB over HTTP on the native driver port.`说明连接成功

**总结：每次启动mongoDB，都需要在命令行先运行 `mongod` ,再新开一个命令行，运行 `mongo`**

#### 方法二：配置MongoDB服务

1. 在mongoDB的**bin同级目录**新增配置文件 `mongo.conf`
   - 配置文件的作用：
   - 指定数据库文件的存放地址
   - 指定日志文件的存放地址
   - 指定端口号和访问的IP地址

~~~cfg
# mongo.conf

storage:
  dbPath: C:\Program Files\MongoDB\Server\4.2\data
  journal:
    enabled: true

systemLog:
  destination: file
  logAppend: true
  path:  C:\Program Files\MongoDB\Server\4.2\log\mongod.log

net:
  port: 27017
  bindIp: 127.0.0.1
~~~

2. 安装mongoDB服务并且指定配置文件

   - 为避免权限问题，建议使用如下方式打开：打开电脑C盘，搜索 system32进入，找到 cmd，以管理员方式打开

   - 安装 mongoDb服务，通过命令行进入mongoDB安装的bin目录下面，输入如下命令即可

   - 注意：mongoDB为服务名，可以自定义，但是为了提高辨识度，一般定义为MongoDB

     ~~~shell
     mongod -config "我们新增的配置文件的绝对路径，xx/xx/mongo.conf" -install -serviceName "MongoDB"
     ~~~

   - **开启服务**

     ~~~shell
     net start MongoDB
     ~~~

   - 有如下显示则开启成功

     ~~~shell
     MongoDB 服务正在启动 .
     MongoDB 服务已经启动成功。
     ~~~

   - 关闭服务

     ~~~shell
     net stop MongoDB
     ~~~

3. 万一我们需要删除服务，可以这样操作

   - 使用管理员方式进去cmd

   - 进入mongoDB安装的bin目录下面

   - 执行如下命令，注意 mongoDB为服务名，即我们创建的时候 -serviceName后面的那个名字

     ~~~shell
      mongod.exe --remove --serviceName "MongoDB"
     ~~~

     

### 1.5 mongoDB图形化工具

[Robo 3T下载地址]( https://robomongo.org/download。)

[Robo 3T使用教程](https://www.cnblogs.com/tugenhua0707/p/9250673.html)

**注意：**使用图形化工具连接数据库的时候，要先开启mongoDB的服务，否则连不上

开启mongoDB服务：`Ctrl  + shift  + Esc`，选择服务，找到MongoDB开启即可



## 二. MongoDB基本使用

- **创建数据库**（新建的数据库不会显示，除非添加数据）

  ~~~js
  use dataBaseName
  ~~~

- **删除数据库**（删除的是当前数据库，首先要切换到该数据库）

  ~~~js
  db.dropDatabase()
  ~~~

- **查看所有数据库**

  ~~~js
  show dbs
  ~~~

- **创建集合**

  ~~~js
  db.createCollection(name, options)
  ~~~

- **删除集合**

  ~~~js
  db.集合名.drop()
  ~~~

- **集合的增删改查**

  - 新增

    ~~~js
    db.COLLECTION_NAME.insert(document)
    ~~~

  - 修改